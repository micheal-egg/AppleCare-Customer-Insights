<!-- Just a Flask test for HTML -->

<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AppleCare Customer Insights</title>
    <style>
      body{font-family:system-ui;margin:2rem}
      input,select,button{padding:.5rem;margin:.5rem}
      table{border-collapse:collapse;width:100%;margin-top:1rem}
      th,td{border:1px solid #ddd;padding:.5rem;text-align:left}
      th{background:#f4f4f4}
    </style>
  </head>
  <body>
    <h2>AppleCare Customer Insights â€” Search</h2>
    <input id="q" placeholder="Type a keyword...">
    <label>Min Rating:</label>
    <select id="min_rating">
      <option>1</option><option>2</option><option>3</option>
      <option>4</option><option selected>5</option>
    </select>
    <button onclick="run()">Search</button>

    <table id="tbl">
      <thead>
        <tr>
          <th>Date</th><th>Product</th><th>Region</th>
          <th>Rating</th><th>Comment</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      async function run(){
        const q = document.getElementById('q').value;
        const r = document.getElementById('min_rating').value;
        const res = await fetch(`/api/search?q=${encodeURIComponent(q)}&min_rating=${r}`);
        const data = await res.json();
        const tb = document.querySelector('#tbl tbody');
        tb.innerHTML = '';
        for(const row of data){
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${row.submitted_at}</td>
            <td>${row.product_line}</td>
            <td>${row.region}</td>
            <td>${row.rating}</td>
            <td>${row.comment_clean}</td>`;
          tb.appendChild(tr);
        }
      }
    </script>
  </body>
</html>
